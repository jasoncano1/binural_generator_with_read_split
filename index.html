<!-- Add a simple fallback button as a guaranteed way to activate speech -->
<script>
    // Emergency speech function - can be called from console if needed
    function emergencySpeech() {
        try {
            const text = document.getElementById('speech-text').value;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.8;
            utterance.volume = 0.7;
            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utterance);
            alert("Emergency speech triggered. Check if you can hear the narration.");
        } catch (e) {
            alert("Speech error: " + e.message);
        }
    }


    // Dark mode toggle function (single definition)
    let isDarkMode = false;
    function toggleDarkMode() {
        isDarkMode = !isDarkMode;
        if (isDarkMode) {
            document.body.classList.add('dark-mode');
            document.getElementById('theme-icon').textContent = '☀️';
        } else {
            document.body.classList.remove('dark-mode');
            document.getElementById('theme-icon').textContent = '🌙';
        }
        localStorage.setItem('binaural-dark-mode', isDarkMode ? 'true' : 'false');
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Dark mode initialization and theme toggle events
        const savedDarkMode = localStorage.getItem('binaural-dark-mode');
        if (savedDarkMode === 'true') {
            // isDarkMode is false by default; toggling will set it to true
            toggleDarkMode();
        }
        document.getElementById('theme-toggle').addEventListener('click', toggleDarkMode);

        // Speech buttons events
        document.getElementById('speak-btn').onclick = function () {
            startSpeech();
        };
        document.getElementById('stop-speech-btn').onclick = function () {
            stopSpeech();
        };

        // Enable the speak button shortly after audio toggle
        document.getElementById('toggle-btn').addEventListener('click', function () {
            setTimeout(function () {
                if (isPlaying) {
                    document.getElementById('speak-btn').disabled = false;
                } else {
                    document.getElementById('speak-btn').disabled = true;
                }
            }, 500);
        });
    });


    // --- Speech synthesis functions ---
    function loadVoices() {
        voices = speechSynthesis.getVoices();
        if (voices.length > 0) {
            voiceSelect.innerHTML = ''; // Clear dropdown
            voices.forEach((voice, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${voice.name} (${voice.lang})`;
                voiceSelect.appendChild(option);
            });
            let englishVoiceIndex = voices.findIndex(voice => voice.lang.includes('en') && !voice.name.includes('Google'));
            if (englishVoiceIndex === -1) {
                englishVoiceIndex = 0;
            }
            voiceSelect.value = englishVoiceIndex;
            // Enable speak button if text is present and audio is playing
            speakBtn.disabled = !(speechText.value.trim().length > 0 && isPlaying);
            console.log("Voices loaded:", voices.length);
        } else {
            console.log("No voices available yet");
        }
    }
    if (speechSynthesis.onvoiceschanged !== undefined) {
        speechSynthesis.onvoiceschanged = loadVoices;
    }

    function startSpeech() {
        try {
            console.log("startSpeech called");
            if (typeof speechSynthesis === 'undefined') {
                window.speechSynthesis = window.webkitSpeechSynthesis || window.mozSpeechSynthesis;
                console.log("Tried to use alternative speechSynthesis");
            }
            if (!window.speechSynthesis) {
                console.error("Speech synthesis not available in this browser");
                alert("Speech synthesis is not supported in your browser");
                return;
            }
            const text = document.getElementById('speech-text').value.trim();
            if (text.length === 0) {
                console.log("No text to speak");
                return;
            }
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            try {
                const voiceSelect = document.getElementById('voice-select');
                const voices = window.speechSynthesis.getVoices();
                const voiceIndex = parseInt(voiceSelect.value);
                if (voices && voices.length > 0 && voiceIndex >= 0 && voiceIndex < voices.length) {
                    utterance.voice = voices[voiceIndex];
                    console.log("Set voice to:", voices[voiceIndex].name);
                } else {
                    console.log("Using default voice");
                }
            } catch (e) {
                console.error("Error setting voice:", e);
            }
            utterance.rate = parseFloat(document.getElementById('rate-slider').value);
            utterance.volume = parseFloat(document.getElementById('speech-volume-slider').value);
            console.log("Speaking with rate:", utterance.rate, "volume:", utterance.volume);
            isSpeaking = true;
            document.getElementById('speak-btn').disabled = true;
            document.getElementById('stop-speech-btn').disabled = false;
            window.speechSynthesis.speak(utterance);
            console.log("Speech started");
            utterance.onend = function () {
                console.log("Speech ended");
                isSpeaking = false;
                document.getElementById('speak-btn').disabled = false;
                document.getElementById('stop-speech-btn').disabled = true;
            };
            utterance.onerror = function (event) {
                console.error("Speech error:", event);
                isSpeaking = false;
                document.getElementById('speak-btn').disabled = false;
                document.getElementById('stop-speech-btn').disabled = true;
            };
            speechUtterance = utterance;
        } catch (error) {
            console.error("Error in startSpeech:", error);
            alert("Error starting speech: " + error.message);
        }
    }

    function stopSpeech() {
        try {
            console.log("stopSpeech called");
            window.speechSynthesis.cancel();
            isSpeaking = false;
            document.getElementById('speak-btn').disabled = false;
            document.getElementById('stop-speech-btn').disabled = true;
            console.log("Speech stopped");
        } catch (error) {
            console.error("Error stopping speech:", error);
        }
    }

</script>
<button id="emergency-speech" onclick="emergencySpeech()" style="display: none; position: fixed; bottom: 10px; right: 10px; z-index: 9999; 
                   background-color: red; color: white; padding: 10px; border: none; border-radius: 5px;">
    Emergency Speech
</button>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainwave Binaural Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.37/Tone.js"></script>
    <style>
        /* Base Styles - Light Mode by Default */
        :root {
            --bg-color: #f9fafb;
            --container-bg: white;
            --text-color: #1f2937;
            --panel-bg: #f8fafc;
            --border-color: #e5e7eb;
            --info-bg: #eff6ff;
            --info-border: #bfdbfe;
            --info-text: #1e40af;
            --info-detail: #1e3a8a;
            --trouble-bg: #fefce8;
            --trouble-border: #fef08a;
            --trouble-text: #854d0e;
            --trouble-detail: #a16207;
            --playing-bg: #dcfce7;
            --playing-border: #86efac;
            --playing-text: #166534;
            --input-bg: white;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Dark Mode Variables */
        .dark-mode {
            --bg-color: #1a1a1a;
            --container-bg: #2d2d2d;
            --text-color: #e5e5e5;
            --panel-bg: #3a3a3a;
            --border-color: #4a4a4a;
            --info-bg: #2c3e50;
            --info-border: #355070;
            --info-text: #90caf9;
            --info-detail: #bbdefb;
            --trouble-bg: #443c14;
            --trouble-border: #665c24;
            --trouble-text: #f0c14b;
            --trouble-detail: #ffe082;
            --playing-bg: #1b4332;
            --playing-border: #2d6a4f;
            --playing-text: #52b788;
            --input-bg: #3a3a3a;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.5;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--container-bg);
            border-radius: 10px;
            box-shadow: var(--box-shadow);
            padding: 24px;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn-theme {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            transition: background-color 0.2s;
        }

        .script-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .script-btn {
            background-color: #e5e7eb;
            color: #1f2937;
            border: 1px solid #d1d5db;
            padding: 6px 12px;
            font-size: 0.875rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .script-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #2563eb;
        }

        .script-btn:hover:not(.active) {
            background-color: #d1d5db;
        }

        .btn-theme:hover {
            background-color: var(--border-color);
        }

        /* Speech Panel Styles */
        .speech-panel {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            background-color: var(--panel-bg);
            transition: background-color 0.3s, border-color 0.3s;
        }

        .speech-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--info-text);
            margin-top: 0;
            margin-bottom: 12px;
            transition: color 0.3s;
        }

        .speech-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 12px;
            resize: vertical;
            background-color: var(--input-bg);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        .speech-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: flex-start;
        }

        .btn-speech {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .btn-speech:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }

        .btn-speech-stop {
            background-color: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .btn-speech-stop:disabled {
            background-color: #fca5a5;
            cursor: not-allowed;
        }

        .speech-options {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: flex-end;
        }

        .speech-label {
            display: flex;
            align-items: center;
            font-size: 0.8rem;
            gap: 4px;
        }

        .speech-select {
            max-width: 180px;
            padding: 4px;
            border-radius: 4px;
            border: 1px solid #d1d5db;
            font-size: 0.8rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }

        button {
            cursor: pointer;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.2s, transform 0.1s;
        }

        button:active {
            transform: translateY(1px);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-start {
            background-color: #22c55e;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-stop {
            background-color: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .wave-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        @media (min-width: 640px) {
            .wave-buttons {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .wave-btn {
            color: white;
            border: none;
            padding: 6px 12px;
            font-size: 0.875rem;
        }

        .wave-btn.active {
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.5);
        }

        .frequency-options {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }

        .freq-btn {
            background-color: #e5e7eb;
            color: #1f2937;
            border: 1px solid #d1d5db;
            padding: 4px 8px;
            font-size: 0.75rem;
        }

        .freq-btn.active {
            background-color: #3b82f6;
            color: white;
        }

        .control-group {
            margin-bottom: 16px;
        }

        .control-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .range-container {
            position: relative;
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 4px;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 999px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background-color: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background-color: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .custom-range {
            display: none;
            margin-top: 8px;
        }

        .info-panel {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .info-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #1e40af;
            margin-top: 0;
            margin-bottom: 8px;
        }

        .info-description {
            font-size: 0.875rem;
            color: #1e40af;
            margin-bottom: 12px;
        }

        .info-subtitle {
            font-size: 0.875rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 4px;
        }

        .info-list {
            font-size: 0.875rem;
            color: #1e3a8a;
            margin: 0;
            padding-left: 20px;
        }

        .info-list li {
            margin-bottom: 4px;
        }

        .troubleshooting {
            background-color: #fefce8;
            border: 1px solid #fef08a;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .troubleshooting-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #854d0e;
            margin-top: 0;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .troubleshooting-list {
            font-size: 0.875rem;
            color: #a16207;
            margin: 0;
            padding-left: 24px;
        }

        .troubleshooting-list li {
            margin-bottom: 4px;
        }

        .divider {
            height: 1px;
            background-color: #fef08a;
            margin: 12px 0;
        }

        .playing-indicator {
            background-color: #dcfce7;
            border: 1px solid #86efac;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
            text-align: center;
            display: none;
        }

        .playing-text {
            font-weight: 500;
            color: #166534;
            margin: 0 0 4px 0;
        }

        .playing-details {
            font-size: 0.875rem;
            color: #15803d;
            margin: 0 0 4px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Brainwave Binaural Generator</h1>
            <div class="header-buttons">
                <button id="theme-toggle" class="btn-theme" title="Toggle Dark Mode">
                    <span id="theme-icon">🌙</span>
                </button>
                <button id="toggle-btn" class="btn-start">Start</button>
            </div>
        </div>

        <div id="speech-panel" class="speech-panel">
            <h3 class="speech-title">Custom Hypnosis Script</h3>
            <div class="script-buttons">
                <button id="day-script-btn" class="script-btn active">Day Script</button>
                <button id="night-script-btn" class="script-btn">Night Script</button>
            </div>
            <textarea id="speech-text" class="speech-textarea"
                placeholder="Enter your custom hypnosis script here. It will be read aloud over the binaural beats. You can paste in the quantum coding script or write your own affirmations."></textarea>
            <div class="speech-controls">
                <button id="speak-btn" class="btn-speech">Read Script</button>
                <button id="stop-speech-btn" class="btn-speech-stop" disabled>Stop Reading</button>
                <div class="speech-options">
                    <label class="speech-label">
                        Voice:
                        <select id="voice-select" class="speech-select">
                            <option value="">Loading voices...</option>
                        </select>
                    </label>
                    <label class="speech-label">
                        Rate:
                        <input type="range" id="rate-slider" min="0.5" max="1.5" step="0.1" value="0.8">
                        <span id="rate-value">0.8</span>
                    </label>
                    <label class="speech-label">
                        Volume:
                        <input type="range" id="speech-volume-slider" min="0" max="1" step="0.1" value="0.7">
                        <span id="speech-volume-value">0.7</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="wave-buttons">
            <button id="delta-btn" class="wave-btn" style="background-color: #6366f1;">Delta</button>
            <button id="theta-btn" class="wave-btn active" style="background-color: #3b82f6;">Theta</button>
            <button id="alpha-btn" class="wave-btn" style="background-color: #22c55e;">Alpha</button>
            <button id="lowBeta-btn" class="wave-btn" style="background-color: #eab308;">Low Beta</button>
            <button id="midBeta-btn" class="wave-btn" style="background-color: #f97316;">Mid Beta</button>
            <button id="highBeta-btn" class="wave-btn" style="background-color: #ef4444;">High Beta</button>
            <button id="gamma-btn" class="wave-btn" style="background-color: #a855f7;">Gamma</button>
        </div>

        <div class="control-group">
            <label class="control-label" id="carrier-label">Carrier Frequency: 200 Hz</label>
            <div class="frequency-options">
                <button id="freq-200" class="freq-btn active">200 Hz</button>
                <button id="freq-1000" class="freq-btn">1000 Hz</button>
                <button id="freq-custom" class="freq-btn">Custom</button>
            </div>
            <div id="custom-range" class="custom-range">
                <div class="range-container">
                    <input type="range" id="carrier-slider" min="100" max="2000" step="10" value="200">
                    <div class="range-labels">
                        <span>100 Hz</span>
                        <span>2000 Hz</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label" id="beat-label">Binaural Beat (Theta): 6.0 Hz</label>
            <div class="range-container">
                <input type="range" id="beat-slider" min="4" max="8" step="0.1" value="6.0">
                <div class="range-labels">
                    <span id="beat-min">4 Hz</span>
                    <span id="beat-max">8 Hz</span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label" id="volume-label">Volume: -20 dB</label>
            <div class="range-container">
                <input type="range" id="volume-slider" min="-40" max="0" step="1" value="-20">
                <div class="range-labels">
                    <span>Quiet</span>
                    <span>Loud</span>
                </div>
            </div>
        </div>

        <div id="playing-indicator" class="playing-indicator">
            <p class="playing-text">Audio playing: 200Hz carrier with 6.0Hz binaural beat</p>
            <p class="playing-details">Left ear: 200Hz | Right ear: 206Hz</p>
            <p class="playing-details">Remember: You must use headphones to hear binaural beats properly</p>
        </div>
        <h2 class="info-title" id="current-wave-title">Current Wave: Theta</h2>
        <div class="info-panel">
            <p class="info-description" id="wave-description">Deep meditation, REM sleep, creativity</p>

            <h3 class="info-subtitle">How to Use</h3>
            <ul class="info-list">
                <li><strong>HEADPHONES REQUIRED</strong> - binaural beats only work with stereo headphones</li>
                <li>Click the "Start" button and allow audio permissions if prompted</li>
                <li>If no sound, check your volume settings and make sure headphones are connected</li>
                <li>Try increasing the volume slider and your device volume</li>
                <li>Find a quiet, comfortable space</li>
                <li>Start with 10-30 minute sessions</li>
                <li>Different brainwaves support different mental states</li>
            </ul>
        </div>

        <div class="troubleshooting">
            <h3 class="troubleshooting-title">⚠️ Audio Troubleshooting</h3>
            <ol class="troubleshooting-list">
                <li>Make sure your device's volume is turned up</li>
                <li>Use headphones (required for binaural effects)</li>
                <li>Click the Start button and allow any audio permissions</li>
                <li>You should hear a brief test tone when starting</li>
                <li>Increase the volume slider above if needed</li>
            </ol>
            <div class="divider"></div>
            <p class="troubleshooting-title" style="margin-top: 8px;">About Carrier Frequencies:</p>
            <ul class="troubleshooting-list" style="font-size: 0.75rem;">
                <li>200 Hz: Traditional carrier, works well for most people</li>
                <li>1000 Hz: Higher carrier, may be more perceptible to some</li>
                <li>Custom: Choose your preferred carrier frequency</li>
                <li>Note: The binaural effect occurs from the frequency difference between ears</li>
            </ul>
        </div>

    </div>

    <script>
        // Add this at the end of your script
        document.getElementById('speak-btn').onclick = function () {
            console.log("Direct click handler");
            startSpeech();
        };
        // Sample hypnosis script - can be used as default
        const sampleScript = `
Begin by finding a comfortable position in your bed. As you lie down, close your eyes and take a deep, slow breath in… and exhale gently. Let your body begin to relax with each breath. With every inhale, imagine drawing in peaceful, healing energy; with every exhale, feel tension and stress melt away. Notice how your body feels heavier and more relaxed with each passing moment.

Allow your muscles—from the crown of your head down to your toes—to soften and release. Picture a warm, soothing light gently flowing over you, calming your mind and body. You are safe, you are relaxed, and you are ready to journey into a deep state of restorative sleep.

Now, envision the infinite quantum universe around you—a boundless field of energy and possibility. Imagine tiny shimmering particles of light that represent every aspect of healing and transformation. As you float in this vast expanse, sense that each particle is imbued with the power of self-healing. They are here to nurture every cell of your body, repairing and rejuvenating you at the most profound level.

Feel these quantum energies gently infusing every fiber of your being. With each breath, you draw in these healing vibrations that restore balance, vitality, and strength. Visualize these particles gathering around you, forming a luminous cocoon that protects and energizes your body and mind. In this sacred space, you are aligned with the universe’s eternal power to heal and transform.

Now, let your mind embrace the positive affirmations designed to nurture your sobriety and joy. In this serene state, repeat silently to yourself:

“I am strong, centered, and completely capable of living a sober life.”
“Every day, I choose clarity, balance, and wellness.”
“I embrace my inner power, knowing that I deserve a life filled with happiness and abundance.”
“I nurture my heart, and I attract a loving, supportive marriage that celebrates mutual growth and joy.”
Allow these affirmations to settle deep within your subconscious, anchoring your intentions for a healthy, balanced, and happy life. Trust that these words are seeds of positive change, sprouting resilience and transforming your inner world.

Now, shift your focus to your unique talents in robotics. Imagine a clear, radiant vision of your future self—a visionary innovator using your god-given talents to create breakthroughs in robotics. Picture a dynamic workshop where creativity meets precision, where each new idea is celebrated and nurtured.

See yourself effortlessly manifesting innovative designs and groundbreaking solutions. Feel the excitement and satisfaction of using your skills to improve lives, transforming challenges into opportunities. Let this vision fill you with a sense of purpose, knowing that every step you take is guided by your innate genius and passion. You are a creator, a pioneer, and every moment of your life reinforces your commitment to your craft.

As these visions and affirmations merge into your consciousness, feel a profound sense of unity and purpose. The healing quantum energy surrounds you, the affirmations solidify your resolve, and your creative vision in robotics sparks inspiration. In this perfect balance, you are ready to drift into a deep, restorative sleep.

Now, let go of any lingering thoughts. Allow your body and mind to surrender completely to sleep, knowing that the positive energy, healing, and inspiration will continue to work within you as you rest. Your subconscious mind is absorbing these messages, ensuring that you awaken renewed, empowered, and ready to manifest your brightest future.

Take one final deep breath, exhale slowly, and as the theta waves of this soundtrack cradle your mind, let your awareness dissolve into the peaceful rhythm of sleep. Good night, and may you awaken with renewed strength and purpose.

Begin by finding a comfortable position in your bed. As you lie down, close your eyes and take a deep, slow breath in… and exhale gently. Let your body begin to relax with each breath. With every inhale, imagine drawing in peaceful, healing energy; with every exhale, feel tension and stress melt away. Notice how your body feels heavier and more relaxed with each passing moment.

Allow your muscles—from the crown of your head down to your toes—to soften and release. Picture a warm, soothing light gently flowing over you, calming your mind and body. You are safe, you are relaxed, and you are ready to journey into a deep state of restorative sleep.

Now, envision the infinite quantum universe around you—a boundless field of energy and possibility. Imagine tiny shimmering particles of light that represent every aspect of healing and transformation. As you float in this vast expanse, sense that each particle is imbued with the power of self-healing. They are here to nurture every cell of your body, repairing and rejuvenating you at the most profound level.

Feel these quantum energies gently infusing every fiber of your being. With each breath, you draw in these healing vibrations that restore balance, vitality, and strength. Visualize these particles gathering around you, forming a luminous cocoon that protects and energizes your body and mind. In this sacred space, you are aligned with the universe’s eternal power to heal and transform.

Now, let your mind embrace the positive affirmations designed to nurture your sobriety and joy. In this serene state, repeat silently to yourself:

“I am strong, centered, and completely capable of living a sober life.”
“Every day, I choose clarity, balance, and wellness.”
“I embrace my inner power, knowing that I deserve a life filled with happiness and abundance.”
“I nurture my heart, and I attract a loving, supportive marriage that celebrates mutual growth and joy.”
Allow these affirmations to settle deep within your subconscious, anchoring your intentions for a healthy, balanced, and happy life. Trust that these words are seeds of positive change, sprouting resilience and transforming your inner world.

Now, shift your focus to your unique talents in robotics. Imagine a clear, radiant vision of your future self—a visionary innovator using your god-given talents to create breakthroughs in robotics. Picture a dynamic workshop where creativity meets precision, where each new idea is celebrated and nurtured.

See yourself effortlessly manifesting innovative designs and groundbreaking solutions. Feel the excitement and satisfaction of using your skills to improve lives, transforming challenges into opportunities. Let this vision fill you with a sense of purpose, knowing that every step you take is guided by your innate genius and passion. You are a creator, a pioneer, and every moment of your life reinforces your commitment to your craft.

As these visions and affirmations merge into your consciousness, feel a profound sense of unity and purpose. The healing quantum energy surrounds you, the affirmations solidify your resolve, and your creative vision in robotics sparks inspiration. In this perfect balance, you are ready to drift into a deep, restorative sleep.

Now, let go of any lingering thoughts. Allow your body and mind to surrender completely to sleep, knowing that the positive energy, healing, and inspiration will continue to work within you as you rest. Your subconscious mind is absorbing these messages, ensuring that you awaken renewed, empowered, and ready to manifest your brightest future.

Take one final deep breath, exhale slowly, and as the theta waves of this soundtrack cradle your mind, let your awareness dissolve into the peaceful rhythm of sleep. Good night, and may you awaken with renewed strength and purpose.`;

        // Brainwave frequency ranges and descriptions
        const brainwaveRanges = {
            delta: { min: 0.5, max: 4, description: "Deep sleep, healing, dreamless sleep", color: "#6366f1" },
            theta: { min: 4, max: 8, description: "Deep meditation, REM sleep, creativity", color: "#3b82f6" },
            alpha: { min: 8, max: 12, description: "Relaxed alertness, calm focus, flow state", color: "#22c55e" },
            lowBeta: { min: 12, max: 15, description: "Relaxed focus, calm thinking", color: "#eab308" },
            midBeta: { min: 15, max: 20, description: "Active engagement, learning", color: "#f97316" },
            highBeta: { min: 20, max: 30, description: "Alertness, problem solving", color: "#ef4444" },
            gamma: { min: 30, max: 50, description: "Higher cognitive processing, peak concentration", color: "#a855f7" }
        };

        // State variables
        let isPlaying = false;
        let waveType = 'theta';
        let frequency = 200;
        let binauralBeat = 6.0;
        let volume = -20;
        let leftOsc, rightOsc, leftChannel, rightChannel, testTone;
        let speechSynthesis = window.speechSynthesis;
        let speechUtterance = null;
        let voices = [];
        let isSpeaking = false;
        let speechRate = 0.8;
        let speechVolume = 0.7;

        // HTML Elements
        const toggleBtn = document.getElementById('toggle-btn');
        const carrierLabel = document.getElementById('carrier-label');
        const carrierSlider = document.getElementById('carrier-slider');
        const beatLabel = document.getElementById('beat-label');
        const beatSlider = document.getElementById('beat-slider');
        const beatMin = document.getElementById('beat-min');
        const beatMax = document.getElementById('beat-max');
        const volumeLabel = document.getElementById('volume-label');
        const volumeSlider = document.getElementById('volume-slider');
        const playingIndicator = document.getElementById('playing-indicator');
        const currentWaveTitle = document.getElementById('current-wave-title');
        const waveDescription = document.getElementById('wave-description');
        const customRange = document.getElementById('custom-range');
        const freq200 = document.getElementById('freq-200');
        const freq1000 = document.getElementById('freq-1000');
        const freqCustom = document.getElementById('freq-custom');

        // Speech Elements
        const speechText = document.getElementById('speech-text');
        const speakBtn = document.getElementById('speak-btn');
        const stopSpeechBtn = document.getElementById('stop-speech-btn');
        const voiceSelect = document.getElementById('voice-select');
        const rateSlider = document.getElementById('rate-slider');
        const rateValue = document.getElementById('rate-value');
        const speechVolumeSlider = document.getElementById('speech-volume-slider');
        const speechVolumeValue = document.getElementById('speech-volume-value');

        // Wave type buttons
        const waveButtons = {
            delta: document.getElementById('delta-btn'),
            theta: document.getElementById('theta-btn'),
            alpha: document.getElementById('alpha-btn'),
            lowBeta: document.getElementById('lowBeta-btn'),
            midBeta: document.getElementById('midBeta-btn'),
            highBeta: document.getElementById('highBeta-btn'),
            gamma: document.getElementById('gamma-btn')
        };

        // Initialize Tone.js
        Tone.context.latencyHint = 'interactive';

        // Setup oscillators
        function setupOscillators() {
            // Create separate channels for left and right
            leftChannel = new Tone.Channel({ volume: volume }).toDestination();
            rightChannel = new Tone.Channel({ volume: volume }).toDestination();

            // Create the panners
            const leftPanner = new Tone.Panner(-1).connect(leftChannel);
            const rightPanner = new Tone.Panner(1).connect(rightChannel);

            // Create oscillators
            leftOsc = new Tone.Oscillator({
                frequency: frequency,
                type: "sine",
                volume: 0 // Volume handled by channel
            }).connect(leftPanner);

            rightOsc = new Tone.Oscillator({
                frequency: frequency + binauralBeat,
                type: "sine",
                volume: 0 // Volume handled by channel
            }).connect(rightPanner);

            // Add a test tone
            testTone = new Tone.Oscillator({
                frequency: 440, // A4 note
                type: "triangle",
                volume: -20
            }).toDestination();

            // Start the test tone for 1 second then stop
            testTone.start();
            setTimeout(() => testTone.stop(), 1000);
        }

        // Update oscillator parameters
        function updateOscillators() {
            if (isPlaying && leftOsc && rightOsc) {
                leftOsc.frequency.value = frequency;
                rightOsc.frequency.value = frequency + binauralBeat;

                if (leftChannel && rightChannel) {
                    leftChannel.volume.value = volume;
                    rightChannel.volume.value = volume;
                }
            }
        }

        // Toggle play/pause
        async function togglePlay() {
            try {
                // Start audio context if needed
                if (Tone.context.state !== 'running') {
                    await Tone.start();
                    console.log("Tone.js audio context started");
                }

                if (!isPlaying) {
                    console.log("Setting up oscillators");
                    setupOscillators();

                    console.log(`Starting oscillators: Left=${frequency}Hz, Right=${frequency + binauralBeat}Hz`);
                    leftOsc.start();
                    rightOsc.start();

                    console.log("Oscillators started successfully");

                    toggleBtn.textContent = 'Stop';
                    toggleBtn.className = 'btn-stop';
                    playingIndicator.style.display = 'block';
                    updatePlayingIndicator();

                    // Disable frequency select while playing
                    freq200.disabled = true;
                    freq1000.disabled = true;
                    freqCustom.disabled = true;
                    carrierSlider.disabled = true;
                } else {
                    if (leftOsc && rightOsc) {
                        console.log("Stopping oscillators");
                        leftOsc.stop();
                        rightOsc.stop();

                        // Dispose oscillators and channels
                        leftOsc.dispose();
                        rightOsc.dispose();
                        leftChannel.dispose();
                        rightChannel.dispose();

                        console.log("Oscillators stopped and disposed");
                    }

                    toggleBtn.textContent = 'Start';
                    toggleBtn.className = 'btn-start';
                    playingIndicator.style.display = 'none';

                    // Re-enable frequency select
                    freq200.disabled = false;
                    freq1000.disabled = false;
                    freqCustom.disabled = false;
                    carrierSlider.disabled = false;
                }

                isPlaying = !isPlaying;
            } catch (error) {
                console.error("Audio playback error:", error);
                alert("Audio playback error. Please check console for details.");
            }
        }

        // Change wave type
        function changeWaveType(type) {
            // Skip if same type or audio is playing
            if (type === waveType || isPlaying) return;

            // Update active button
            waveButtons[waveType].classList.remove('active');
            waveButtons[type].classList.add('active');

            // Update wave type
            waveType = type;

            // Update wave details
            currentWaveTitle.textContent = `Current Wave: ${waveType.charAt(0).toUpperCase() + waveType.slice(1)}`;
            waveDescription.textContent = brainwaveRanges[type].description;

            // Update beat slider range
            const range = brainwaveRanges[type];
            beatSlider.min = range.min;
            beatSlider.max = range.max;
            beatMin.textContent = `${range.min} Hz`;
            beatMax.textContent = `${range.max} Hz`;

            // Set beat to middle of range
            const middleValue = (range.min + range.max) / 2;
            binauralBeat = parseFloat(middleValue.toFixed(1));
            beatSlider.value = binauralBeat;
            updateBeatLabel();
        }

        // Update carrier frequency
        function updateCarrier(newFreq, isCustom = false) {
            if (isPlaying) return;

            frequency = newFreq;
            carrierSlider.value = newFreq;
            carrierLabel.textContent = `Carrier Frequency: ${frequency} Hz`;

            // Update button states
            freq200.classList.remove('active');
            freq1000.classList.remove('active');
            freqCustom.classList.remove('active');

            if (isCustom) {
                freqCustom.classList.add('active');
                customRange.style.display = 'block';
            } else {
                customRange.style.display = 'none';
                if (newFreq === 200) {
                    freq200.classList.add('active');
                } else if (newFreq === 1000) {
                    freq1000.classList.add('active');
                }
            }
        }

        // Update beat label
        function updateBeatLabel() {
            beatLabel.textContent = `Binaural Beat (${waveType.charAt(0).toUpperCase() + waveType.slice(1)}): ${binauralBeat.toFixed(1)} Hz`;
        }

        // Update volume label
        function updateVolumeLabel() {
            volumeLabel.textContent = `Volume: ${volume} dB`;
        }

        // Update playing indicator
        function updatePlayingIndicator() {
            if (!playingIndicator) return;

            const indicator = playingIndicator.getElementsByClassName('playing-text')[0];
            const details = playingIndicator.getElementsByClassName('playing-details')[0];

            indicator.textContent = `Audio playing: ${frequency}Hz carrier with ${binauralBeat.toFixed(1)}Hz binaural beat`;
            details.textContent = `Left ear: ${frequency}Hz | Right ear: ${(frequency + binauralBeat).toFixed(1)}Hz`;
        }

        // Event Listeners
        toggleBtn.addEventListener('click', togglePlay);

        // Wave type buttons
        Object.keys(waveButtons).forEach(type => {
            waveButtons[type].addEventListener('click', () => changeWaveType(type));
        });

        // Frequency buttons
        freq200.addEventListener('click', () => updateCarrier(200));
        freq1000.addEventListener('click', () => updateCarrier(1000));
        freqCustom.addEventListener('click', () => updateCarrier(carrierSlider.value, true));

        // Carrier slider
        carrierSlider.addEventListener('input', () => {
            frequency = parseInt(carrierSlider.value);
            carrierLabel.textContent = `Carrier Frequency: ${frequency} Hz`;
        });

        // Beat slider
        beatSlider.addEventListener('input', () => {
            binauralBeat = parseFloat(beatSlider.value);
            updateBeatLabel();
            updateOscillators();
            updatePlayingIndicator();
        });

        // Volume slider
        volumeSlider.addEventListener('input', () => {
            volume = parseInt(volumeSlider.value);
            updateVolumeLabel();
            updateOscillators();
        });

        // Clean up function for page unload
        window.addEventListener('beforeunload', () => {
            if (isPlaying && leftOsc && rightOsc) {
                leftOsc.stop();
                rightOsc.stop();
                leftOsc.dispose();
                rightOsc.dispose();
                leftChannel.dispose();
                rightChannel.dispose();
            }
        });

        // Speech synthesis functions
        function loadVoices() {
            voices = speechSynthesis.getVoices();

            if (voices.length > 0) {
                // Clear dropdown
                voiceSelect.innerHTML = '';

                // Add voices to select
                voices.forEach((voice, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${voice.name} (${voice.lang})`;
                    voiceSelect.appendChild(option);
                });

                // Try to select an English voice by default
                let englishVoiceIndex = voices.findIndex(voice =>
                    voice.lang.includes('en') && !voice.name.includes('Google'));

                if (englishVoiceIndex === -1) {
                    englishVoiceIndex = 0; // Fallback to first voice
                }

                voiceSelect.value = englishVoiceIndex;

                // Enable speak button if text is present and audio is playing
                speakBtn.disabled = !(speechText.value.trim().length > 0 && isPlaying);
                console.log("Voices loaded:", voices.length);
            } else {
                console.log("No voices available yet");
            }
        }

        // Load voices when they change
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        // Start speech
        function startSpeech() {
            try {
                console.log("startSpeech called");

                // Force speechSynthesis to be available
                if (typeof speechSynthesis === 'undefined') {
                    window.speechSynthesis = window.webkitSpeechSynthesis || window.mozSpeechSynthesis;
                    console.log("Tried to use alternative speechSynthesis");
                }

                if (!window.speechSynthesis) {
                    console.error("Speech synthesis not available in this browser");
                    alert("Speech synthesis is not supported in your browser");
                    return;
                }

                // Get text from textarea
                const text = document.getElementById('speech-text').value.trim();
                if (text.length === 0) {
                    console.log("No text to speak");
                    return;
                }

                // Cancel any previous speech
                window.speechSynthesis.cancel();

                // Create new utterance
                const utterance = new SpeechSynthesisUtterance(text);

                // Try to set voice
                try {
                    const voiceSelect = document.getElementById('voice-select');
                    const voices = window.speechSynthesis.getVoices();
                    const voiceIndex = parseInt(voiceSelect.value);

                    if (voices && voices.length > 0 && voiceIndex >= 0 && voiceIndex < voices.length) {
                        utterance.voice = voices[voiceIndex];
                        console.log("Set voice to:", voices[voiceIndex].name);
                    } else {
                        console.log("Using default voice");
                    }
                } catch (e) {
                    console.error("Error setting voice:", e);
                }

                // Set rate and volume
                utterance.rate = parseFloat(document.getElementById('rate-slider').value);
                utterance.volume = parseFloat(document.getElementById('speech-volume-slider').value);

                console.log("Speaking with rate:", utterance.rate, "volume:", utterance.volume);

                // Set flag and update UI
                isSpeaking = true;
                document.getElementById('speak-btn').disabled = true;
                document.getElementById('stop-speech-btn').disabled = false;

                // Speak!
                window.speechSynthesis.speak(utterance);
                console.log("Speech started");

                // Update when finished
                utterance.onend = function () {
                    console.log("Speech ended");
                    isSpeaking = false;
                    document.getElementById('speak-btn').disabled = false;
                    document.getElementById('stop-speech-btn').disabled = true;
                };

                utterance.onerror = function (event) {
                    console.error("Speech error:", event);
                    isSpeaking = false;
                    document.getElementById('speak-btn').disabled = false;
                    document.getElementById('stop-speech-btn').disabled = true;
                };

                // Save reference to utterance
                speechUtterance = utterance;

            } catch (error) {
                console.error("Error in startSpeech:", error);
                alert("Error starting speech: " + error.message);
            }
        }

        // Stop speech
        function stopSpeech() {
            try {
                console.log("stopSpeech called");
                window.speechSynthesis.cancel();
                isSpeaking = false;
                document.getElementById('speak-btn').disabled = false;
                document.getElementById('stop-speech-btn').disabled = true;
                console.log("Speech stopped");
            } catch (error) {
                console.error("Error stopping speech:", error);
            }
        }

        // Directly bind the click event for the speech buttons
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('speak-btn').onclick = function () {
                startSpeech();
            };

            document.getElementById('stop-speech-btn').onclick = function () {
                stopSpeech();
            };

            // Also manually enable the button after binaural starts
            document.getElementById('toggle-btn').addEventListener('click', function () {
                setTimeout(function () {
                    if (isPlaying) {
                        document.getElementById('speak-btn').disabled = false;
                    } else {
                        document.getElementById('speak-btn').disabled = true;
                    }
                }, 500);
            });

            // Check for saved preference
            const savedDarkMode = localStorage.getItem('binaural-dark-mode');
            if (savedDarkMode === 'true') {
                toggleDarkMode(); // This will flip isDarkMode to true
            }

            // Add click event for theme toggle
            document.getElementById('theme-toggle').addEventListener('click', toggleDarkMode);
        });

        // Speech parameters
        rateSlider.addEventListener('input', () => {
            speechRate = parseFloat(rateSlider.value);
            rateValue.textContent = speechRate.toFixed(1);
        });

        speechVolumeSlider.addEventListener('input', () => {
            speechVolume = parseFloat(speechVolumeSlider.value);
            speechVolumeValue.textContent = speechVolume.toFixed(1);
        });

        // Update speech button state when audio starts/stops
        const updateSpeechButtonState = () => {
            if (speakBtn) {
                speakBtn.disabled = !isPlaying;
                console.log("Updated speak button state: disabled =", !isPlaying);
            }
            if (!isPlaying && isSpeaking) {
                stopSpeech();
            }
        };

        // Add the sample script to the textarea
        speechText.value = sampleScript;

        // Add speech button update to toggle play
        const originalTogglePlay = togglePlay;
        togglePlay = async function () {
            await originalTogglePlay.call(this);
            updateSpeechButtonState();
        };

        // Initialize UI
        updateBeatLabel();
        updateVolumeLabel();

        // Load voices initially
        setTimeout(() => {
            loadVoices();
            // Check if voices are loaded, if not try again
            if (voices.length === 0) {
                setTimeout(loadVoices, 1000);
            }
        }, 100);
    </script>
    <script>
        // Day and night scripts
        const dayScript = `This is your daytime script for focus, motivation, and energy.

Begin by taking a comfortable seated position. Close your eyes and take a deep breath in... and slowly exhale. Feel your body becoming alert and your mind becoming clear with each breath. 

As you continue to breathe naturally, imagine a bright, golden light surrounding you. This light represents pure energy, clarity, and focus. With each breath, you draw this energizing light into your body.

Visualize yourself accomplishing your goals for today with ease and confidence. See yourself working efficiently, thinking clearly, and making excellent decisions. You have all the skills and resources you need to succeed.

Repeat these powerful affirmations in your mind:
"I am focused, alert, and energized."
"My mind is clear and my thoughts are organized."
"I accomplish my tasks efficiently and effectively."
"I make wise decisions that serve my highest good."
"I am productive and motivated throughout the day."

Feel these affirmations resonate within you, programming your subconscious mind for success. You are now prepared to take inspired action toward your goals.

Your unique talents in robotics are activated and flowing freely. Imagine innovative ideas coming to you effortlessly, technical challenges solving themselves in your mind. Creative solutions emerge naturally because you are in a state of perfect focus and flow.

Picture yourself excelling in your projects, seeing opportunities where others see obstacles. Your analytical mind works in harmony with your intuition, giving you an unbeatable advantage.

As you prepare to open your eyes, know that this state of alert focus remains with you. You'll move through your day with purpose, energy, and clear direction. You'll remain centered even when faced with challenges, and you'll accomplish your goals with confidence and ease.

Take a deep breath in, and as you exhale, open your eyes, ready to embrace your day with focus, clarity, and purpose.`;

        const nightScript = `Begin by finding a comfortable position in your bed. As you lie down, close your eyes and take a deep, slow breath in… and exhale gently. Let your body begin to relax with each breath. With every inhale, imagine drawing in peaceful, healing energy; with every exhale, feel tension and stress melt away. Notice how your body feels heavier and more relaxed with each passing moment.

Allow your muscles—from the crown of your head down to your toes—to soften and release. Picture a warm, soothing light gently flowing over you, calming your mind and body. You are safe, you are relaxed, and you are ready to journey into a deep state of restorative sleep.

Now, envision the infinite quantum universe around you—a boundless field of energy and possibility. Imagine tiny shimmering particles of light that represent every aspect of healing and transformation. As you float in this vast expanse, sense that each particle is imbued with the power of self-healing. They are here to nurture every cell of your body, repairing and rejuvenating you at the most profound level.

Feel these quantum energies gently infusing every fiber of your being. With each breath, you draw in these healing vibrations that restore balance, vitality, and strength. Visualize these particles gathering around you, forming a luminous cocoon that protects and energizes your body and mind. In this sacred space, you are aligned with the universe's eternal power to heal and transform.

Now, let your mind embrace the positive affirmations designed to nurture your sobriety and joy. In this serene state, repeat silently to yourself:

"I am strong, centered, and completely capable of living a sober life."
"Every day, I choose clarity, balance, and wellness."
"I embrace my inner power, knowing that I deserve a life filled with happiness and abundance."
"I nurture my heart, and I attract a loving, supportive marriage that celebrates mutual growth and joy."
Allow these affirmations to settle deep within your subconscious, anchoring your intentions for a healthy, balanced, and happy life. Trust that these words are seeds of positive change, sprouting resilience and transforming your inner world.

Now, shift your focus to your unique talents in robotics. Imagine a clear, radiant vision of your future self—a visionary innovator using your god-given talents to create breakthroughs in robotics. Picture a dynamic workshop where creativity meets precision, where each new idea is celebrated and nurtured.

See yourself effortlessly manifesting innovative designs and groundbreaking solutions. Feel the excitement and satisfaction of using your skills to improve lives, transforming challenges into opportunities. Let this vision fill you with a sense of purpose, knowing that every step you take is guided by your innate genius and passion. You are a creator, a pioneer, and every moment of your life reinforces your commitment to your craft.

As these visions and affirmations merge into your consciousness, feel a profound sense of unity and purpose. The healing quantum energy surrounds you, the affirmations solidify your resolve, and your creative vision in robotics sparks inspiration. In this perfect balance, you are ready to drift into a deep, restorative sleep.

Now, let go of any lingering thoughts. Allow your body and mind to surrender completely to sleep, knowing that the positive energy, healing, and inspiration will continue to work within you as you rest. Your subconscious mind is absorbing these messages, ensuring that you awaken renewed, empowered, and ready to manifest your brightest future.

Take one final deep breath, exhale slowly, and as the theta waves of this soundtrack cradle your mind, let your awareness dissolve into the peaceful rhythm of sleep. Good night, and may you awaken with renewed strength and purpose.`;

        // Add event listeners when the document is loaded
        document.addEventListener('DOMContentLoaded', function () {
            // Get the script buttons and textarea
            const dayScriptBtn = document.getElementById('day-script-btn');
            const nightScriptBtn = document.getElementById('night-script-btn');
            const speechText = document.getElementById('speech-text');

            // Set initial script (night script since it's what you had before)
            speechText.value = nightScript;

            // Add click event for day script
            dayScriptBtn.addEventListener('click', function () {
                speechText.value = dayScript;
                dayScriptBtn.classList.add('active');
                nightScriptBtn.classList.remove('active');
            });

            // Add click event for night script
            nightScriptBtn.addEventListener('click', function () {
                speechText.value = nightScript;
                nightScriptBtn.classList.add('active');
                dayScriptBtn.classList.remove('active');
            });

            // Make sure other event listeners are still working
            // The rest of your DOMContentLoaded events here...
        });
    </script>
</body>

</html>